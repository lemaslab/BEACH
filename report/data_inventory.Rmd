---
title: "Data Inventory: Physical Activity"
author: "Dominick Lemas"
date: "February 22, 2020"
output:
  html_document:
    highlight: tango
    theme: spacelab
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE, warning = FALSE}

library(knitr, warn.conflicts = F, quietly = T)
library(tidyr, warn.conflicts = F, quietly = T)
library(dplyr, warn.conflicts = F, quietly = T)
library(ggplot2, warn.conflicts = F, quietly = T)
library(keyringr, warn.conflicts = F, quietly = T)
library(redcapAPI, warn.conflicts = F, quietly = T)
library(REDCapR, warn.conflicts = F, quietly = T)
library(lubridate, warn.conflicts = F, quietly = T)

#Create path to and api link to RedCaps
credential_label <- "beach_api"
credential_path <- paste(Sys.getenv("USERPROFILE"), '\\DPAPI\\passwords\\', Sys.info()["nodename"], '\\', credential_label, '.txt', sep="")
uri <- "https://redcap.ctsi.ufl.edu/redcap/api/"
beach_token<-decrypt_dpapi_pw(credential_path)

```

```{r variable selection, include=FALSE, warning = FALSE}

# Create connections
rcon <- redcapConnection(url=uri, token=beach_token)

# variables
desired_fields=c("test_id","redcap_event_name",
                 "beach_part_drop_out",
                  "mompa_todays_date","mompa_study_visit",
                  "mompa_walk_slow","mompa_walk_quick",
                  "mompa_walk_hills","mompa_jog",
                  "mompa_prenatal_exer","mompa_swim",
                  "mompa_dance","mompa_other_exer")

,
                  "physical_activity_questionnaire_v3_022118_complete")


# dropped participants
 dropped.records.v1=c("BLS006A",
                      "BLS010A",
                      "BLS015A",
                      "BLS026A",
                      "BLS029A",
                      "BLS037A",
                      "BLS039A",
                      "BLS050A",
                      "BLS054A")

# pull data
dat<- redcap_read(
  batch_size=300,
  records= dropped.records.v1,
  redcap_uri = uri, 
  token      = beach_token, 
  fields     = desired_fields
  )$data

```
